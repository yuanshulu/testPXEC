(window.webpackJsonp=window.webpackJsonp||[]).push([[9,2],{330:function(t,e,n){"use strict";n.r(e);var r=[{key:"parent_name",label:"大分類"},{key:"category_name",label:"子分類"},{key:"status",label:"狀態"},{key:"func",label:"功能"}],o={name:"Table",props:{items:{type:Array,default:function(){return[]}}},data:function(){return{fields:r,pagination:{align:"center",doubleArrows:!1}}}},c=n(12),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CCard",[n("CCardHeader",[t._t("header",(function(){return[n("CIcon",{attrs:{name:"cil-grid"}}),t._v(" Table\n    ")]}))],2),t._v(" "),n("CCardBody",[n("CDataTable",{attrs:{border:"",items:t.items,fields:t.fields,"items-per-page":20,pagination:t.pagination,hover:""},scopedSlots:t._u([{key:"func",fn:function(e){var r=e.item;return[n("td",[r.can_set_inactive?n("button",{staticClass:"btn btn-warning mr-4",on:{click:function(e){return t.$parent.setCategoryActive(r,!1)}}},[t._v("下架")]):t._e(),t._v(" "),r.can_set_active?n("button",{staticClass:"btn btn-success mr-4",on:{click:function(e){return t.$parent.setCategoryActive(r,!0)}}},[t._v("上架")]):t._e(),t._v(" "),r.can_edit?n("button",{staticClass:"btn btn-primary mr-4",on:{click:function(e){return t.$parent.openEdit(r,!1)}}},[t._v("編輯")]):t._e(),t._v(" "),r.can_delete?n("button",{staticClass:"btn btn-danger mr-4",on:{click:function(e){return t.$parent.deleteCategory(r)}}},[t._v("刪除")]):t._e()])]}}])})],1)],1)}),[],!1,null,null,null);e.default=component.exports},346:function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(54),n(34),n(55),{name:"CategoryList",components:{CategoryListTable:n(330).default},data:function(){return{loading:!1,collapse:!1,isAdd:!0,categoryList:[],editData:{parent_id:null,category_name:"",id:null},editingCategory:{id:0,parentId:"",categoryName:""},horizontal:{label:"col-3",input:"col-9"},topCategoryOptions:[],statusOptions:["下架","上架"],categoriesData:[]}},computed:{topCategoryOptionList:function(){var t=[{value:null,label:"無"}];return this.categoryList.forEach((function(e){e.parent_id||t.push({value:e.id,label:e.parent_name})})),t}},mounted:function(){this.getCategory()},methods:{openEdit:function(t,e){e&&(this.collapse=!0,this.isAdd=e,e||(this.editData={id:t.id,parent_id:t.parent_id,category_name:t.category_name}))},resetEditData:function(){this.collapse=!1,this.editData={parent_id:null,category_name:""}},getCategory:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.getCategoryList();case 3:n=e.sent,t.categoryList=n.data,t.loading=!1,e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),alert("取得列表失敗"),t.categoryList=[],console.log(e.t0),t.loading=!1;case 14:case"end":return e.stop()}}),e,null,[[0,8]])})))()},editCategory:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.editData.category_name){e.next=3;break}return alert("請輸入商品分類名稱"),e.abrupt("return");case 3:if(t.loading=!0,!t.isAdd){e.next=20;break}return e.prev=5,e.next=8,t.$api.addCategory({parent_id:t.editData.parent_id,category_name:t.editData.category_name});case 8:alert("新增成功"),t.collapse=!1,t.getCategory(),t.editData={id:null,parent_id:null,category_name:""},e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),console.log(e.t0),alert("新增失敗");case 18:e.next=33;break;case 20:return e.prev=20,e.next=23,t.$api.updateCategory(t.editData);case 23:alert("編輯成功"),t.collapse=!1,t.getCategory(),t.editData={id:null,parent_id:null,category_name:""},e.next=33;break;case 29:e.prev=29,e.t1=e.catch(20),console.log(e.t1),alert("編輯失敗");case 33:case"end":return e.stop()}}),e,null,[[5,14],[20,29]])})))()},setCategoryActive:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=t.parent_name||t.category_name,confirm("確定要".concat(e?"上架":"下架","[").concat(o,"]嗎？"))){r.next=3;break}return r.abrupt("return");case 3:return n.loading=!0,r.prev=4,r.next=7,n.$api.setCategoryActive({id:t.id,is_active:e});case 7:alert("".concat(e?"上架":"下架","[").concat(o,"]成功")),n.getCategory(),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(4),alert("".concat(e?"上架":"下架","[").concat(o,"]失敗")),console.log(r.t0);case 15:case"end":return r.stop()}}),r,null,[[4,11]])})))()},deleteCategory:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.parent_name||t.category_name,confirm("確定要刪除[".concat(r,"]嗎？"))){n.next=3;break}return n.abrupt("return");case 3:return e.loading=!0,n.prev=4,n.next=7,e.$api.deleteCategory({id:t.id});case 7:alert("刪除 [".concat(r,"]成功")),e.getCategory(),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(4),console.log(n.t0),alert("刪除 [".concat(r,"]失敗"));case 15:case"end":return n.stop()}}),n,null,[[4,11]])})))()}}}),c=n(12),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("CCard",[n("CCardHeader",[n("h3",[t._v("商品分類設定")]),t._v(" "),n("CButton",{staticClass:"float-right",attrs:{color:"primary"},on:{click:function(e){return t.openEdit(null,!0)}}},[t._v("新增分類")])],1),t._v(" "),n("CCollapse",{attrs:{show:t.collapse}},[n("CCardBody",[n("CForm",{attrs:{inline:""}},[n("CInput",{staticClass:"col-5",attrs:{label:"商品分類名稱",horizontal:""},model:{value:t.editData.category_name,callback:function(e){t.$set(t.editData,"category_name",e)},expression:"editData.category_name"}}),t._v(" "),n("CSelect",{staticClass:"col-5",attrs:{value:t.editData.parent_id,label:"上層分類",horizontal:"",options:t.topCategoryOptionList},on:{"update:value":function(e){return t.$set(t.editData,"parent_id",e)}}}),t._v(" "),n("CButton",{staticClass:"ml-4",attrs:{color:"danger"},on:{click:t.resetEditData}},[n("CIcon",{attrs:{name:"cil-ban"}}),t._v("\n            取消\n          ")],1),t._v(" "),n("CButton",{staticClass:"ml-2",attrs:{color:"primary"},on:{click:t.editCategory}},[n("CIcon",{attrs:{name:"cil-check-circle"}}),t._v("\n            儲存\n          ")],1)],1)],1)],1),t._v(" "),t.loading?n("CElementCover"):t._e()],1),t._v(" "),n("CRow",[n("CCol",{attrs:{md:"12"}},[n("CategoryListTable",{attrs:{items:t.categoryList},scopedSlots:t._u([{key:"header",fn:function(){return[n("CIcon",{attrs:{name:"cil-grid"}}),t._v(" 分類列表\n        ")]},proxy:!0}])}),t._v(" "),t.loading?n("CElementCover"):t._e()],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CategoryListTable:n(330).default})}}]);