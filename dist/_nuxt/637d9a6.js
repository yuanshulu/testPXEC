(window.webpackJsonp=window.webpackJsonp||[]).push([[23,7],{330:function(t,e,r){"use strict";r.r(e);r(38),r(35),r(26),r(52),r(34),r(53);var o=r(24),n=(r(39),r(40),r(56));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d=[{key:"salesStartTime",label:"上檔時間"},{key:"salesEndTime",label:"下檔時間"},{key:"itemNo",label:"單品貨號"},{key:"barcode",label:"單品條碼"},{key:"productName",label:"品名規格",sorter:!1},{key:"col6",label:"目前開團數"},{key:"col7",label:"剩餘庫存"},{key:"statusName",label:"狀態"},{key:"func",label:"功能",_style:"min-width:180px",sorter:!1}],v={name:"ProductListDataTable",props:{items:{type:Array,default:function(){return[]}}},data:function(){return{fields:d,pagination:{align:"center",doubleArrows:!1}}},computed:l(l({},Object(n.b)(["getUserProfile"])),{},{checkScope:function(){return!!this.getUserProfile.scopes.includes("deal_approve")}})},m=r(12),component=Object(m.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("CCard",[r("CCardHeader",[t._t("header",(function(){return[r("CIcon",{attrs:{name:"cil-grid"}}),t._v("Table")]}))],2),t._v(" "),r("CCardBody",[r("CDataTable",{attrs:{border:!0,items:t.items,fields:t.fields,sorter:"","items-per-page":20,pagination:t.pagination,hover:""},scopedSlots:t._u([{key:"func",fn:function(e){var o=e.item;return[r("td",[r("CButtonToolbar",["草稿"==o.statusName||"審核未過"==o.statusName||"下架"==o.statusName?r("CButton",{attrs:{color:"primary"},on:{click:function(e){return t.$parent.edit(o.id)}}},[t._v("\n              編輯\n            ")]):t._e(),t._v(" "),"草稿"==o.statusName||"審核未過"==o.statusName?r("CButton",{attrs:{color:"primary"},on:{click:function(e){return t.$parent.confirmRequestReview(o.id)}}},[t._v("\n              送審\n            ")]):t._e(),t._v(" "),"待審核"==o.statusName||"審核通過"==o.statusName?r("CButton",{attrs:{color:"danger"},on:{click:function(e){return t.$parent.confirmReject(o.id)}}},[t._v("\n              退回\n            ")]):t._e(),t._v(" "),"待審核"==o.statusName?r("CButton",{attrs:{color:"primary"},on:{click:function(e){return t.$parent.confirmApprove(o.id)}}},[t._v("\n              審核通過\n            ")]):t._e(),t._v(" "),"上架中"==o.statusName?r("CButton",{attrs:{color:"danger"},on:{click:function(e){return t.$parent.stopSellingProduct(o.id)}}},[t._v("\n              下架\n            ")]):t._e()],1)],1)]}}])})],1)],1)}),[],!1,null,null,null);e.default=component.exports},337:function(t,e,r){var content=r(346);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(89).default)("dca5c9fe",content,!0,{sourceMap:!1})},345:function(t,e,r){"use strict";r(337)},346:function(t,e,r){var o=r(88)(!1);o.push([t.i,".summary-navs[data-v-1fc7b330]{font-size:1.3em;display:flex;justify-content:space-evenly}.summary-navs .summary-nav[data-v-1fc7b330]{width:160px}.summary-navs .summary-nav a.nav-link[data-v-1fc7b330]{display:block;border-bottom:2px solid transparent}.summary-navs .summary-nav a.nav-link[data-v-1fc7b330]:not(.nav-link-actived):hover{border-bottom:2px solid #d3d3d3}.summary-navs .summary-nav a.nav-link-actived[data-v-1fc7b330]{border-bottom:2px solid #f08080}",""]),t.exports=o},361:function(t,e,r){"use strict";r.r(e);r(38),r(35),r(26),r(52),r(34),r(53);var o=r(7),n=r(24),c=(r(13),r(27),r(36),r(185),r(66),r(54),r(56));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={name:"ProductList",components:{ProductListTable:r(330).default},data:function(){return{products:[],summary:{allCount:0,draftCount:0,reviewCount:0,notReadyCount:0,readyCount:0,activeCount:0,inactiveCount:0},effectId:0,requestReviewModalShow:!1,approveModalShow:!1,rejectModalShow:!1,reject_command:""}},computed:d(d({},Object(c.b)(["getProductListActiveIndex"])),{},{navActivedIndex:function(){return this.getProductListActiveIndex}}),mounted:function(){this.reloadData()},methods:d(d({},Object(c.c)(["setProductListActiveIndex"])),{},{downloadSample:function(){window.location.href="/assets/templates/產品測試上傳.xlsx"},reloadData:function(){this.setProductSummary(),this.setProductList(this.navActivedIndex)},setProductSummary:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.getProductSummary();case 3:r=e.sent,t.summary=r.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},setProductList:function(t){var e=this,r=new URLSearchParams({status:t}),o=this.$store.state.urls.listProducts+"?"+r.toString();console.log("listProducts, call "+o),this.$axios.get(o).then((function(t){if(t.data.code===e.$store.state.success){var data=t.data.data;for(var i in e.products=[],data){var r=data[i];e.products.push({id:r.id,salesStartTime:r.sales_start_time,salesEndTime:r.sales_end_time,itemNo:r.item_no,barcode:r.barcode,productName:r.product_name,col6:"####",col7:"####",statusName:r.status_name})}}})).then((function(){e.$store.commit("setProductListActiveIndex",t)}))},edit:function(t){this.$router.push({name:"新增商品",params:{pid:t}})},confirmRequestReview:function(t){this.effectId=t,this.requestReviewModalShow=!0},requestReview:function(){var t=this,e=this.$store.state.urls.requestProductReview;console.log("requestProductReview, call "+e);var r={effect_id:this.effectId};this.axios.post(e,r).then((function(e){if(e.data.code===t.$store.state.success){var data=e.data.data;console.log(data)}})).then((function(){t.requestReviewModalShow=!1,t.reloadData()}))},confirmReject:function(t){this.effectId=t,this.rejectModalShow=!0},reject:function(){var t=this;if(""===this.reject_command)return alert("退回原因為必填"),!1;var e=this.$store.state.urls.rejectProduct;console.log("rejectProduct, call "+e);var r={effect_id:this.effectId,reject_command:this.reject_command};this.axios.post(e,r).then((function(e){if(e.data.code===t.$store.state.success){var data=e.data.data;console.log(data)}})).then((function(){t.rejectModalShow=!1,t.reloadData()}))},confirmApprove:function(t){this.effectId=t,this.approveModalShow=!0},approve:function(){var t=this,e=this.$store.state.urls.approveProduct;console.log("approveProduct, call "+e);var r={effect_id:this.effectId};this.axios.post(e,r).then((function(e){if(e.data.code===t.$store.state.success){var data=e.data.data;console.log(data)}})).then((function(){t.approveModalShow=!1,t.reloadData()}))},stopSellingProduct:function(t){var e=this,r=this.$store.state.urls.stopSellingProduct;console.log("stopSellingProduct, call "+r);var o={effect_id:t};this.axios.post(r,o).then((function(t){t.data.code,e.$store.state.success})).then((function(){e.approveModalShow=!1,e.reloadData()}))}})},m=(r(345),r(12)),component=Object(m.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("CRow",[r("CCol",[r("CCard",[r("CCardHeader",[r("h3",[t._v("商品管理")]),t._v(" "),r("CButtonGroup",{staticClass:"float-right"},[r("router-link",{attrs:{to:"/product/addProduct"}},[r("CButton",{attrs:{color:"primary"}},[t._v("\n                新增商品\n              ")])],1),t._v(" "),r("router-link",{attrs:{to:"/product/importFromExcel"}},[r("CButton",{staticClass:"ml-2",attrs:{color:"primary"}},[t._v("\n              商品庫上傳\n            ")])],1),t._v(" "),r("router-link",{attrs:{to:"/static/templates/產品測試上傳.xlsx",target:"_blank"}},[r("CButton",{staticClass:"ml-2",attrs:{color:"link"}},[t._v("\n              商品檔案範本下載\n            ")])],1),t._v(" "),r("router-link",{attrs:{to:"/product/productSearch"}},[r("CButton",{staticClass:"ml-2",attrs:{color:"primary"}},[t._v("\n                搜尋\n              ")])],1)],1)],1),t._v(" "),r("CCardBody",[r("CRow",[r("CCol",{attrs:{md:"12"}},[r("div",{staticClass:"summary-navs",staticStyle:{"font-size":"1.3em",display:"flex"}},[r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":0==t.navActivedIndex},on:{click:function(e){return t.setProductList(0)}}},[r("div",[t._v("全部")]),t._v(" "),r("div",[t._v(t._s(t.summary.all_count))])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":1==t.navActivedIndex},on:{click:function(e){return t.setProductList(1)}}},[r("div",[t._v("草稿")]),t._v(" "),r("div",[t._v(t._s(t.summary.draft_count))])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":2==t.navActivedIndex},on:{click:function(e){return t.setProductList(2)}}},[r("div",[t._v("待審核")]),t._v(" "),r("div",[t._v(t._s(t.summary.review_count))])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":3==t.navActivedIndex},on:{click:function(e){return t.setProductList(3)}}},[r("div",[t._v("審核未過")]),t._v(" "),r("div",[t._v("\n                      "+t._s(t.summary.not_ready_count)+"\n                    ")])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":4==t.navActivedIndex},on:{click:function(e){return t.setProductList(4)}}},[r("div",[t._v("審核通過")]),t._v(" "),r("div",[t._v("\n                      "+t._s(t.summary.ready_count)+"\n                    ")])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":5==t.navActivedIndex},on:{click:function(e){return t.setProductList(5)}}},[r("div",[t._v("上架中")]),t._v(" "),r("div",[t._v("\n                      "+t._s(t.summary.active_count)+"\n                    ")])])]),t._v(" "),r("div",{staticClass:"text-center summary-nav"},[r("a",{staticClass:"nav-link",class:{"nav-link-actived":6==t.navActivedIndex},on:{click:function(e){return t.setProductList(6)}}},[r("div",[t._v("已下架")]),t._v(" "),r("div",[t._v("\n                      "+t._s(t.summary.inactive_count)+"\n                    ")])])])])])],1)],1),t._v(" "),r("CCardFooter")],1)],1)],1),t._v(" "),r("CRow",[r("CCol",[r("ProductListTable",{attrs:{items:t.products},scopedSlots:t._u([{key:"header",fn:function(){return[r("CIcon",{attrs:{name:"cil-grid"}}),t._v(" 商品列表\n        ")]},proxy:!0}])})],1)],1),t._v(" "),r("CModal",{attrs:{title:"送審確認",show:t.requestReviewModalShow},on:{"update:show":function(e){t.requestReviewModalShow=e}}},[t._v("\n    請確定欄位都已填寫要送出審核了嗎?\n    "),r("div",{staticClass:"w-100",attrs:{slot:"footer"},slot:"footer"},[r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem",color:"white"},attrs:{color:"info"},on:{click:function(e){return t.requestReview()}}},[t._v("\n         是 \n      ")]),t._v(" "),r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem"},attrs:{color:"light"},on:{click:function(e){t.requestReviewModalShow=!1}}},[t._v("\n        取消\n      ")])],1)]),t._v(" "),r("CModal",{attrs:{title:"退回提醒",show:t.rejectModalShow},on:{"update:show":function(e){t.rejectModalShow=e}}},[r("h6",[t._v("審核未過需填寫原因，再請填寫原因")]),t._v(" "),r("CTextarea",{attrs:{placeholder:"退回原因",rows:"4"},model:{value:t.reject_command,callback:function(e){t.reject_command=e},expression:"reject_command"}}),t._v(" "),r("div",{staticClass:"w-100",attrs:{slot:"footer"},slot:"footer"},[r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem",color:"white"},attrs:{color:"info"},on:{click:function(e){return t.reject()}}},[t._v("\n         是 \n      ")]),t._v(" "),r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem"},attrs:{color:"light"},on:{click:function(e){t.rejectModalShow=!1}}},[t._v("\n        取消\n      ")])],1)],1),t._v(" "),r("CModal",{attrs:{title:"審核完成確認",show:t.approveModalShow},on:{"update:show":function(e){t.approveModalShow=e}}},[t._v("\n    審核通過後此商品會依上檔時間自動上架，請問要通過審核嗎??\n    "),r("div",{staticClass:"w-100",attrs:{slot:"footer"},slot:"footer"},[r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem",color:"white"},attrs:{color:"info"},on:{click:function(e){return t.approve()}}},[t._v("\n         是 \n      ")]),t._v(" "),r("CButton",{staticClass:"ml-1 mr-1 float-right",staticStyle:{"border-radius":"0.2rem"},attrs:{color:"light"},on:{click:function(e){t.approveModalShow=!1}}},[t._v("\n        取消\n      ")])],1)])],1)}),[],!1,null,"1fc7b330",null);e.default=component.exports;installComponents(component,{ProductListTable:r(330).default})}}]);